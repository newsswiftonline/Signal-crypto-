<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Crypto Signal Tool with Live Price & Indicators</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #0d1117;
    color: #fff;
    text-align: center;
    padding: 20px;
  }
  .tab-btn {
    padding: 10px 15px;
    background: #161b22;
    color: white;
    border: none;
    margin: 5px;
    cursor: pointer;
    border-radius: 8px;
  }
  .tab-btn.active {
    background-color: #238636;
  }
  .signal-box {
    border: 1px solid #30363d;
    background: #161b22;
    padding: 15px;
    margin: 15px auto;
    width: 90%;
    border-radius: 10px;
    text-align: left;
  }
  .price {
    font-size: 1.4em;
    margin-bottom: 10px;
  }
  .signal {
    font-weight: bold;
    font-size: 1.2em;
  }
  .buy {
    color: #4caf50;
  }
  .sell {
    color: #f44336;
  }
  .neutral {
    color: #ff9800;
  }
  .fakeout {
    color: #ff0000;
    font-weight: bold;
  }
</style>
</head>
<body>
  <h1>üìà Crypto Signal Tool (Live Prices + Indicators)</h1>
  <div>
    <button class="tab-btn active" onclick="showSignals('1h', event)">1H</button>
    <button class="tab-btn" onclick="showSignals('4h', event)">4H</button>
    <button class="tab-btn" onclick="showSignals('1d', event)">1D</button>
  </div>
  <div id="signalContainer">Loading...</div>

<script>
// Your CoinGecko API key if needed (optional, public API available without key)
const API_BASE = "https://api.coingecko.com/api/v3";

// List of coins to track
const coins = ["bitcoin", "ethereum", "ripple"];

// Store signals for each timeframe
const signals = {
  "1h": [],
  "4h": [],
  "1d": [],
};

// Fetch live prices and indicators for a coin
async function fetchCoinData(coinId) {
  const res = await fetch(`${API_BASE}/coins/${coinId}?localization=false&tickers=false&market_data=true&community_data=false&developer_data=false&sparkline=false`);
  if(!res.ok) throw new Error('API Error');
  const data = await res.json();
  return {
    price: data.market_data.current_price.usd,
    rsi: calculateRSI(data.market_data.price_change_percentage_24h), // Simplified RSI based on 24h % change
    ma50: data.market_data.current_price.usd * 0.98,  // Dummy 50 MA 2% below price
    ma200: data.market_data.current_price.usd * 1.02, // Dummy 200 MA 2% above price
  };
}

// Simple RSI calculation placeholder (real RSI requires history)
function calculateRSI(changePercent) {
  // Rough estimate: if price increased a lot, RSI high, else low
  if(changePercent > 5) return 75;
  if(changePercent > 1) return 60;
  if(changePercent > -1) return 50;
  if(changePercent > -5) return 40;
  return 25;
}

// Generate a buy/sell/neutral/fakeout signal based on indicators
function generateSignal(data) {
  const { price, rsi, ma50, ma200 } = data;

  // Smart rules example:
  // Buy if price above MA50 and MA50 above MA200 and RSI < 70 (not overbought)
  if(price > ma50 && ma50 > ma200 && rsi < 70) {
    return { direction: "Buy", className: "buy", fakeout: false };
  }
  // Sell if price below MA50 and MA50 below MA200 and RSI > 30
  if(price < ma50 && ma50 < ma200 && rsi > 30) {
    return { direction: "Sell", className: "sell", fakeout: false };
  }
  // Fakeout: RSI > 80 but price is near MA50 (uncertain)
  if(rsi > 80 && Math.abs(price - ma50) / ma50 < 0.01) {
    return { direction: "Fakeout", className: "fakeout", fakeout: true };
  }
  // Otherwise Neutral
  return { direction: "Neutral", className: "neutral", fakeout: false };
}

// Load signals for all coins for a timeframe (simplified - same data for all timeframes here)
async function loadSignals(timeframe) {
  signals[timeframe] = [];
  for(const coin of coins) {
    try {
      const data = await fetchCoinData(coin);
      const signal = generateSignal(data);
      signals[timeframe].push({
        symbol: coin.toUpperCase(),
        price: data.price.toFixed(2),
        rsi: data.rsi,
        ma50: data.ma50.toFixed(2),
        ma200: data.ma200.toFixed(2),
        direction: signal.direction,
        className: signal.className,
        fakeout: signal.fakeout,
      });
    } catch(e) {
      signals[timeframe].push({
        symbol: coin.toUpperCase(),
        price: "Error",
        rsi: "-",
        ma50: "-",
        ma200: "-",
        direction: "API Error",
        className: "neutral",
        fakeout: false,
      });
    }
  }
}

// Show signals on UI
async function showSignals(timeframe, event) {
  // Highlight active tab
  document.querySelectorAll(".tab-btn").forEach(btn => btn.classList.remove("active"));
  event.target.classList.add("active");

  const container = document.getElementById("signalContainer");
  container.innerHTML = "Loading...";
  
  await loadSignals(timeframe);

  container.innerHTML = "";
  signals[timeframe].forEach(s => {
    container.innerHTML += `
      <div class="signal-box">
        <h3>${s.symbol}</h3>
        <p class="price">Price: $${s.price}</p>
        <p>RSI: ${s.rsi}</p>
        <p>MA50: $${s.ma50} | MA200: $${s.ma200}</p>
        <p class="signal ${s.className}">${s.direction}</p>
        ${s.fakeout ? `<p class="fakeout">‚ö†Ô∏è Fakeout Signal!</p>` : ""}
      </div>
    `;
  });
}

window.onload = () => showSignals("1h");
</script>
</body>
</html>
